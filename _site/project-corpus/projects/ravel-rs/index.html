<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ravel-rs (RAVEL-0 Bootstrap) — Project</title>
    <meta name="description" content="Minimal Rust toolchain that parses a tiny RAVEL-0 language and emits runnable Rust, proving the end-to-end model for a 2‑D programming language with explicit concurrency." />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="/project-corpus/assets-styles.css" />
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <a href="/project-corpus/" style="text-decoration:none;color:var(--muted)">← Back to all projects</a>
        <h1 class="project-title">ravel-rs (RAVEL-0 Bootstrap)</h1>
        <p class="project-subtitle">Minimal Rust toolchain that parses a tiny RAVEL-0 language and emits runnable Rust, proving the end-to-end model for a 2‑D programming language with explicit concurrency.</p>
      </div>
    </header>
    <main class="container project-main">
      <section class="project-content">
        <div class="hero">
          <img src="/project-corpus/placeholder.svg" alt="Conceptual placeholder for the RAVEL 2‑D programming model" />
        </div>

        <h2>Problem</h2>
        <p>
          Build a practical bootstrap for <em>RAVEL</em>, a two‑dimensional programming language where shape is
          meaning. Programs consist of rooms, tiles, and typed wires; concurrency, rendezvous, and timing fences are
          explicit and checkable. The goal is to prove the end‑to‑end path early: parse a canonical textual form,
          compile to efficient executable code, and lay a foundation for effects, rates (SDF), and exact joins.
        </p>

        <h2>Approach</h2>
        <p>
          Start with a <strong>RAVEL‑0</strong> subset and a tiny, fast Rust toolchain that demonstrates the flow:
          canonical text → AST → simple codegen → runnable binary. Keep the language surface deliberately small
          (a single adapter <code>print</code>, <code>room</code> with a <code>ribbon</code> block, string literals,
          identifiers, <code>let</code>, <code>+</code> concatenation, and <code>return</code>) while shipping rich
          documentation that specifies the full core model and roadmap.
        </p>

        <h3>Architecture</h3>
        <ul>
          <li><strong>Crates</strong>: <code>ravelc/</code> (compiler), <code>ravel_runtime/</code> (minimal runtime), <code>genrun/</code> (runner helper).</li>
          <li><strong>Parsing</strong>: pest‑based grammar (<code>ravelc/src/ravel.pest</code>) plus a resilient fallback parser for RAVEL‑0.</li>
          <li><strong>AST</strong>: minimal types and statements (<code>String</code>, <code>()</code>, <code>print</code>, <code>let</code>, <code>return</code>, <code>a + b</code>).</li>
          <li><strong>Codegen</strong>: emits a single Rust <code>main()</code> and a <code>room_*</code> function per room; calls <code>adapter_print()</code>.</li>
          <li><strong>Runtime</strong>: tiny host adapter <code>adapter_print(&amp;str)</code>; future home for FIFOs, bars, joins, per‑token stacks.</li>
          <li><strong>Runner</strong>: build script copies <code>examples/generated_main.rs</code> into <code>OUT_DIR</code> so <code>cargo run -p genrun</code> executes it.</li>
        </ul>

        <h3>Stack</h3>
        <ul>
          <li>Rust 2021 — workspace with three crates.</li>
          <li>pest — PEG parser for the canonical textual dual.</li>
          <li>anyhow — simple error propagation.</li>
          <li>Cargo — reproducible builds and multi‑crate workflow.</li>
        </ul>

        <h3>Challenges</h3>
        <ul>
          <li>Designing a canonical textual form that round‑trips from diagrams and stays diff‑friendly.</li>
          <li>Being permissive to Unicode/whitespace quirks while keeping the grammar strict; solved with a normalization pass and a fallback parser.</li>
          <li>Bridging 2‑D semantics (tiles, lanes, bars, gathers) to a minimal sequential codegen without undermining future guarantees.</li>
        </ul>

        <h2>Outcomes</h2>
        <p>
          An end‑to‑end toolchain that compiles and runs a RAVEL‑0 program, plus a comprehensive technical spec
          (<code>DOCUMENTATION.md</code>) laying out types, effects, SDF rates, cardinality obligations, runtime shape,
          and a staged roadmap to 0.2 and beyond.
        </p>

        <h2>Usage</h2>
        <p>The repository includes a <code>hello.ravel</code> example and two ways to run the generated code.</p>
        <pre><code># Build the workspace
cargo build

# Generate Rust from RAVEL text
cargo run -p ravelc -- examples/hello.ravel
# → writes examples/generated_main.rs

# Option A: compile the generated file directly
rustc -L target/debug -l dylib=ravel_runtime examples/generated_main.rs -o examples/hello
./examples/hello

# Option B: use the helper runner (copies generated_main.rs via build.rs)
cargo run -p genrun
        </code></pre>

        <h3>Example source</h3>
        <pre><code>adapter print foreign{ffi:"host", fn:"print"} (s:string) -&gt; () effect io&lt;term&gt;;

room Main() -&gt; () {
  ribbon {
    print("Hello, world!");
    return;
  }
}
        </code></pre>

        <section class="updates">
          <h2>Updates</h2>
          
          
          
            <p>No updates yet.</p>
          
        </section>
      </section>

      <aside class="project-aside">
        <dl class="facts">
          <dt>Status</dt>
          <dd><span class="badge status active">Active</span></dd>
          <dt>Tags</dt>
          <dd>Rust, Compilers, DSL, Concurrency, Parsing, IR</dd>
          <dt>Started</dt>
          <dd>Sep 2025</dd>
          <dt>Links</dt>
          <dd>
            <ul>
              <li><a href="#">Live demo (TBD)</a></li>
              <li><a href="#">GitHub (TBD)</a></li>
              <li><a href="#">Technical spec (DOCUMENTATION.md)</a></li>
            </ul>
          </dd>
        </dl>
      </aside>
    </main>
    <footer class="site-footer">
      <div class="container">
        <small>© 2025 Adam Bandel</small>
      </div>
    </footer>
  </body>
  </html>
